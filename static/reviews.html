<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>评价</title>
</head>
<body>
  <h1>添加评价</h1>
  <form id="revForm">
    <label>userId: <input name="userId" value="1"/></label><br />
    <label>productId: <input name="productId" value="1"/></label><br />
    <label>score: <input name="score" value="5"/></label><br />
    <label>content: <input name="content" value="不错"/></label><br />
    <button type="submit">提交评价</button>
    <button type="button" id="backToProducts" style="margin-left:8px">返回商品列表</button>
  </form>
  <pre id="result"></pre>
<script>
const f = document.getElementById('revForm');
f.addEventListener('submit', async (e)=>{
  e.preventDefault();
  const data = Object.fromEntries(new FormData(f).entries());
  const payload = { userId: parseInt(data.userId), productId: parseInt(data.productId), score: parseInt(data.score), content: data.content };
  const res = await fetch('/reviews', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
  const txt = await res.text();
  document.getElementById('result').textContent = txt;
});
document.getElementById('backToProducts').addEventListener('click', ()=>{
  const uid = parseInt(document.querySelector('input[name="userId"]').value) || 0;
  window.location.href = '/static/products.html' + (uid? ('?userId='+uid) : '');
});
</script>
</body>
</html>